# 第七周周报  覃海旭

本周工作主要是对序列推荐方向相关的近期论文进行阅读与总结。

## 一、论文阅读

**1、A Pre-trained Sequential Recommendation Framework: Popularity Dynamics for Zero-shot Transfer**

> 期刊会议：RecSys 2024
> 方向分类：跨域零样本序列推荐

- **解决的问题：**传统的序列推荐模型在不同应用或域之间难以泛化，必须针对每个领域单独训练模型，并且需要辅助信息（如商品描述等）。本研究提出了一种不依赖任何辅助信息的预训练序列推荐框架，以解决跨领域推荐的挑战。
- **创新点：**提出了一个基于物品**流行度动态**的预训练序列推荐框架PrepRec，通过建模物品流行度的变化来学习通用的物品和序列表示。该模型不依赖具体物品的ID或辅助信息，可以实现零样本的跨域和跨应用推荐。
- **模型架构：**
  1. **物品流行度编码器**：模型通过两种时间粒度（长期和短期）来编码物品的流行度动态。长期流行度反映物品的整体受欢迎程度，短期流行度反映近期的趋势变化。
  2. **通用物品表示**：通过结合粗粒度和细粒度的流行度动态来生成通用的物品表示，避免了对具体物品ID的依赖。
  3. **流行度动态感知Transformer**：该架构结合物品流行度、相对时间间隔编码和位置编码，通过多头自注意力机制学习用户的行为序列表示。
  4. **预测模块**：模型利用用户序列的输出与下一个物品的表示计算内积，进行推荐预测。
- **数据集：**Amazon(Office,Tool)，Douban(Movie,Music)，Epinions

**2、Repeated Padding for Sequential Recommendation**

> 期刊会议：RecSys 2024
> 方向分类：序列推荐/数据增强

- **解决的问题：**在序列推荐系统中，模型通常需要处理长度不一的用户交互序列。为了保证批量处理的统一性，序列长度需要对齐，较短的序列通常通过填充特殊值0来补齐，但这种方式无法利用这些填充位置去提升模型的性能和训练效率。

- **创新点：**论文提出了一种简单且有效的填充方法，称为“**重复填充**”（Repeated Padding, RepPad）。该方法通过用原始交互序列反复填充闲置空间，不需要任何可训练参数或超参数，作为一种“即插即用”的数据增强方式。

- **具体实现：**

  假设原始用户交互序列为`su = [v1, v2, v3, v4]`，RepPad将重复该序列填充空闲空间。例如，当最大序列长度为10时，若原始序列长度为4，则会重复填充原始序列。此外，为防止模型混淆头尾序列，RepPad在每次填充之间加入分隔符0，最终生成的序列为`[v1, v2, v3, v4, 0, v1, v2, v3, v4, 0]`

- **数据集：**Amazon(Toys,Beauty,Sports,Home)，Yelp，MovieLens-1M

- **我的问题/想法：**这种重复padding会不会让模型出现使用序列末尾预测序列开头的情况（类似于没masked的Attention)。将序列头尾之间补0变为随机mask会不会更好？比如，假设原始序列是 `[A, B, C]`，经过重复填充后变成了 `[A, B, C, 0, A, B, C, 0, A, B, C]`，那么模型可能会用后面的 `C, 0` 来预测前面的 `A`。如果把填充的0换成随机mask，比如 `[A, B, C, 0, B, C, ...]`，效果会不会更好？

**3、SSDRec: Self-Augmented Sequence Denoising for  Sequential Recommendation**

> 期刊会议：ICDE 2024
> 方向分类：序列推荐/数据增强(序列去噪)

- **解决的问题：**现有的序列推荐方法通常依赖于序列内部的时序性和关联性信息进行去噪，但这往往在处理短序列时容易出现过度去噪和去噪不足(OUPs）的情况。
- **创新点：**提出在去噪前先进行序列增强的方式解决序列去噪中的OUPs问题。
- **模型架构：**
  1. **全局关系编码器：**负责捕捉用户和项目之间的多种关系，并将其作为先验知识用于后续的序列增强。构建了一个包含用户-项目、项目之间的过渡性、非兼容性等关系的多重关系图，用于学习全局信息。
  2. **自我增强模块：**首先通过一个位置选择器检测序列中的不一致项，这些项可能是噪声或在上下文中表现出不同的语义。然后通过项目选择器，从全局项目空间中选择两个最合适的项目插入到序列中。
  3. **分层去噪模块：**进一步消除自我增强模块引入的潜在噪声，并生成无噪声的序列用于推荐。
- **数据集：**Amazon(Beauty,Sports)，Yelp，MovieLens-1M/100K

**4、Scalable Cross-Entropy Loss for Sequential Recommendations with Large Item Catalogs**

> 期刊会议：RecSys 2024
> 方向分类：序列推荐/负采样优化

- **解决的问题：**在序列推荐系统中，当项目目录非常庞大时，传统的交叉熵损失带来的计算和内存消耗过高的问题。

- **创新点：**论文提出了一种可扩展的交叉熵损失函数（Scalable Cross-Entropy,SCE），该方法通过选择性计算来减少计算负担，将计算集中在最有信息量的项目上，特别是那些容易被模型误分类的“困难负样本”，而不是像传统的负采样方法那样随机采样。

- **模型架构：**

  1. **可扩展交叉熵（SCE）:**通过引入桶机制来将模型输出X和item emb Y进行分组，通过只计算与桶中心B接近的X和Y(因为与向量b接近的x和y也会比较接近，以此来找到困难负样本，而无需计算所有x与y的组合的内积），算法能够在不计算所有可能组合的情况下，找到与模型输出相似的困难负样本。

  2. **桶崩溃缓解**：对模型输出 X 进行随机矩阵投影。通过将模型输出矩阵 X 乘以一个随机生成的矩阵 Ω，每个批次的 X 会被重新映射到一个新的子空间中，确保这些向量在新的方向上更加多样化。

     > 概念解释：桶崩溃指的是桶中的元素在分组过程中可能过于集中在少数几个桶中的问题。此时不同的桶中可能共享过多相同的向量（即模型输出 X 或项目嵌入 Y ）。如果一个输入被分配到多个桶，那么除了一个交叉熵值以外，其他所有计算出的交叉熵值都不会被使用（因为取了最大值），从而浪费计算资源。

- **数据集：**BeerAdvocate，Behance，Kindle Store，Yelp，Gowalla

- **我的问题/想法：**桶崩溃缓解的随机投影操作只需要对 X 做而不对 Y 做吗？不一起投影有没有可能造成内积值的改变，就是说一些原本与y相似的x投影后变得不那么相似，而一些投影前不那么相似的x投影后变得相似。

**5、ROTAN: A Rotation-based Temporal Attention Network for Time-Specific Next POI Recommendation**

> 期刊会议：KDD 2024
> 方向分类：POI推荐

- **解决的问题：**

    1. 大多数现有的POI推荐忽略了时间信息。

    2. 传统POI整合时间信息的方法（将时间嵌入与其它嵌入拼接或相加）可能会增加维度并改变它们的原始空间，并且无法自然地反映用户行为中本质的周期性时间模式。
- **创新点：** Time2Rotation：将时间信息编码为旋转向量，通过旋转操作捕捉时间的周期性特征（如日常和每周的循环模式），并与用户和POI的嵌入进行旋转操作，从而避免拼接/相加方法带来的负面影响。
- **模型架构：**
  1. **协作转换图学习模块：**模型首先构建了一个协作POI过渡图。在此图中，节点表示POI，边则表示在不同时段之间的转移关系，Time2Rotation技术用于对这些过渡进行旋转操作，以学习时间感知的过渡模式。

  2. **个体签到轨迹学习模块：**分别对用户和POI的时间序列进行建模，使用两个独立的多头注意力模型分别捕捉用户和POI的时间序列模式。
  3. **特定时间的POI推荐模块：**将目标时间与用户偏好和POI影响的时间序列表示相结合，通过多层感知机计算用户对每个POI的推荐分数。
- **数据集：**NYC，TKY，CA

**6、Going Where, by Whom, and at What Time: Next Location Prediction Considering User Preference and Temporal Regularity**

> 期刊会议：KDD 2024
> 方向分类：POI推荐

- **解决的问题：**以往的研究在预测位置时主要依赖于序列模式的挖掘，通常忽视了以下两点：
  1. **用户偏好：**许多研究未能充分利用人类轨迹中包含的用户偏好信息，即用户倾向于去什么样的地点（例如购物中心、学校等）。
  2. **时间规律：**用户在一天中的不同时间往往去不同的地点，时间点对用户接下来可能去的地点具有很强的预测能力。然而，现有的模型往往只将到达时间作为辅助任务，而没有将其作为关键的上下文信息来直接指导位置预测。
- **创新点：** 
	1. 使用概率主题模型来提取用户对不同类型位置的偏好信息。
	2. 开发了一种基于多头注意力机制的到达时间估计器，以生成到达时间嵌入作为位置预测的上下文信息。
- **模型架构：**
  1. **用户偏好挖掘：**通过历史轨迹中的用户-地点共现矩阵，采用LDA模型生成用户对不同类型活动地点的偏好分布。LDA采用NLP的方法将用户与其访问的地点类比为文档与词语，通过主题生成用户的偏好嵌入。

  2. **到达时间估计：**该模块使用基于多头自注意力的到达时间估计器，生成一个聚合的到达时间嵌入。首先通过时间转移矩阵构建初步的时间上下文，然后结合用户偏好的时间特征，通过多头注意力机制灵活捕捉时间转移模式。最终，生成的到达时间嵌入作为下一步预测的重要上下文信息。
  3. **序列模式挖掘：**利用Transformer架构对用户的活动位置序列进行建模，提取序列嵌入。最终将这些上下文嵌入结合，输入全连接层以预测下一个活动位置。
- **数据集：**Traffic Camera Dataset，Mobile Phone Dataset

## 二、对比总结

**1. 跨域序列推荐与预训练**

- **论文1（PrepRec）** 提出了基于物品流行度动态的预训练框架，以实现跨域零样本推荐。这种方法在于避免使用具体物品的ID或辅助信息，而是通过建模长期和短期的流行度变化，生成通用物品表示。它解决了序列推荐模型跨域泛化的问题。
- **对比点**：与其他方法相比，PrepRec在解决跨域推荐上采取了一种新颖的预训练策略，通过流行度信息捕捉通用表示，而不是依赖于具体的物品描述或ID。

**2. 数据增强技术在序列推荐中的应用**

- **论文2（RepPad）** 通过重复填充用户交互序列以增强训练数据，避免了传统零填充在序列短板上的缺点。虽然这种方式看起来简单，但它通过反复填充原始序列，有效地避免了空闲序列浪费问题。
- **论文3（SSDRec）** 提出了一种结合序列增强与去噪的方式，通过全局关系图和自我增强模块解决过度去噪与去噪不足的问题。
- **对比点**：RepPad和SSDRec都在尝试改进序列推荐的输入处理方式，但RepPad更注重填充策略的简单改进，而SSDRec则结合了全局信息和增强的序列去噪方式，进一步优化序列建模过程。

**3. 大规模项目目录与负采样优化**

- **论文4（SCE）** 针对序列推荐中的大规模项目目录提出了一种可扩展的交叉熵损失，利用桶机制与随机投影减轻了计算负担和桶崩溃问题。
- **对比点**：与RepPad和SSDRec不同，SCE并未关注输入的改进，而是直接对损失函数进行优化，以解决序列推荐系统中计算复杂度的问题。SCE方法特别关注高效的负采样和困难负样本的选择，以提高训练性能。

**4. 时间信息在POI推荐中的应用**

- **论文5（ROTAN）** 针对POI推荐中的时间信息整合问题，提出了一种基于旋转编码的时间特征捕捉方法（Time2Rotation），能够自然反映周期性时间模式。
- **论文6（MCLP）** 通过结合用户偏好与时间规律来优化下一步位置预测，强调了用户偏好信息和到达时间对预测的重要性。
- **对比点**：这两篇论文都专注于POI推荐中的时间信息，但ROTAN通过旋转编码实现时间的周期性捕捉，而Next Location Prediction则重点挖掘用户偏好和时间规律，充分利用时间作为上下文信息来预测位置。

**综合总结：**

- **跨域推荐**（PrepRec）与**数据增强**（RepPad和SSDRec）解决了不同的推荐场景下模型泛化和短序列处理的问题。
- **负采样优化**（SCE）专注于如何有效地处理大规模数据集中的计算瓶颈。
- **POI推荐**（ROTAN和MCLP）则侧重于时间和位置的结合，利用不同的策略来提升推荐精度。