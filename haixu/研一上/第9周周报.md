# 第9周周报 覃海旭

本周工作主要是对跨域推荐方向相关的近期论文进行阅读与总结。

## 一、论文阅读

**1、Discerning Canonical User Representation for Cross-Domain Recommendation**

> 期刊会议：RecSys2024
> 方向分类：跨域推荐/用户表示学习

- **解决的问题：**在用户表示上，现有的跨领域推荐模型采用的方法是使用两种单独的用户表示：

  1. 用于域之间信息共享的域共享表示。
  2. 用于表示每个域内的独特用户兴趣的域特定表示。

  然而，这些模型主要集中在维持领域共享表示的相似性，忽视了域特定表示，从而导致二者的不平衡。这种不平衡可能导致：

  1. 域特定表示与域共享表示过于相似。
  2. 大部分信息集中在域特定表示中，导致域共享表示在训练数据中拟合不足，而域特定表示则过拟合。

  所以本文的目标是让域共享表示尽可能接近的同时与域特定表示进行分离。

- **创新点：**

  1. 传统的典型相关分析(CCA)只对域相关性（域共享表示）进行建模，无法表示领域差异，因此本文引入一种新型的非线性CCA设计——判别典型相关(DisCCA)，在最大化域共享用户表示之间的相关性的同时添加额外的约束来学习域特定表示之间的差异。
  2. 利用生成对抗网络(GAN)，通过生成器和判别器的竞争，学习用户偏好分布，生成更符合用户偏好的推荐结果。

- **模型架构：**DiCUR-CDR的模型架构如下：

  - **GAN**
    1. **生成器：**根据用户的域特定表示和域共享表示生成新的反馈向量。生成的反馈向量作为推荐模型的预测结果。
    2. **判别器：**通过判别真实的用户反馈和生成器生成的反馈，来帮助生成器生成更加真实的推荐结果。为了处理数据稀疏性，模型通过二元掩码机制确保仅有真实的用户反馈参与学习。
  - **DisCCA用户表示学习：**引入可学习映射矩阵和非线性激活，并设计相应的损失函数来进行限制，使得让域共享表示尽可能接近的同时与域特定表示有所区分。

- **数据集：**在下面两个跨域场景下进行实验：

  1. Amazon(Movies and TV/Video Games)
  2. Yelp(Restaurants/Shopping)

**2、Improving Adversarial Robustness for Recommendation Model via Cross-Domain Distributional Adversarial Training**

> 期刊会议：RecSys2024
> 方向分类：跨域推荐/对抗训练

- **解决的问题：**推荐模型在面对对抗样本(AE)攻击时的脆弱性问题。现有的对抗训练（AT）方法虽然在一定程度上增强了推荐模型的鲁棒性，但仍面临两大挑战：
  1. **数据稀疏性问题**：推荐系统中的交互数据通常非常稀疏，导致对抗训练效果不佳。
  2. **点对点扰动的局限性**：现有的AT方法主要使用点对点的扰动策略生成对抗样本，然而不同样本对扰动的敏感性不同，这种策略不能全面提升模型的对抗鲁棒性。
- **创新点：**将跨域推荐的方法引入到对抗训练中，提出跨域分布对抗训练：利用一个更丰富的辅助域来提升稀疏目标域的对抗鲁棒性。
- **模型架构：**CDAT的架构主要包括以下两个模块：
  1. **领域对抗网络（Dan）**：Dan的任务是捕获领域不变的用户偏好分布。它包括一个用户偏好编码器和一个领域判别器，通过对齐来自不同领域的用户嵌入，使得这些嵌入在同一个向量空间中保持一致，从而获得领域不变的用户偏好分布。这个过程帮助目标域能够利用辅助域的对抗鲁棒性。
  2. **跨域对抗样本生成网络（Cdan）**：在获取领域不变的偏好分布后，Cdan网络通过对这些偏好分布进行对抗性扰动，生成高质量的跨域对抗样本。具体实现是采用GAN的方法，生成器生成对抗性扰动样本，判别器区分正常样本和对抗样本，二者联合优化，保证生成的对抗样本既具有攻击性又不可察觉。
  3. **跨域分布对抗训练：**用由Cdan生成的良好的跨域对抗样本对目标域中的推荐器进行对抗性攻击，并更新目标域推荐器的参数 ，以获得更鲁棒的推荐模型。
- **数据集：**在下面三个跨域场景下进行实验：
  1. Douban(Movie/Book)
  2. Douban(Movie/Music)
  3. Amazon(TV/CD)

**3、Hyperbolic Contrastive Learning for Cross-Domain Recommendation**

> 期刊会议：CIKM2024
> 方向分类：跨域推荐/长尾分布

- **解决的问题：**论文针对跨域推荐中的长尾数据分布问题进行研究。长尾分布的数据一直是推荐系统中的一道难题，特别是在跨域推荐场景下，引入其他领域的数据可能会加剧整个数据集的长尾特性，从而使模型更难有效训练。

  传统的推荐模型中，用户和项目的表示通常嵌入在欧几里得空间中，但欧几里得空间无法有效处理具有层次结构和指数增长关系的长尾数据。

- **创新点：**论文提出了一种基于**双曲几何的表示学习方法。**

  **双曲流形**是一种具有恒定负曲率的非欧几里得空间，该空间能够随着半径的增加而呈指数级扩展。这种指数扩展特性使得双曲流形特别适合表示类似树形或层次结构的数据（如长尾分布的数据），因为它可以自然地容纳此类结构中元素的指数增长。

  该论文利用双曲空间的优势来改善跨域推荐任务中用户和项目的表示，并通过跨域知识转移来增强目标域的推荐效果。

- **模型架构：**HCTS主要包括以下几个模块：

  1. **GNN模块**：首先，对源域和目标域分别使用Skip-GCN，将每个域中的用户和项目的邻居信息进行聚合生成相应的欧氏空间中的嵌入。
  2. **双曲流形投影模块**：接下来，模型将源域和目标域的欧式空间嵌入映射到不同曲率的双曲流形上。源域和目标域分别使用可训练的曲率参数来控制嵌入的最优曲率，这种做法使得模型能够更好地捕捉每个领域的结构特点。
  3. **双曲对比学习模块**：首先基于流形对齐函数将双曲流形上领域A中的嵌入映射到领域B的双曲流形上。接着，为了实现跨域的知识传递，设计了三种对比学习任务：
     - **用户-用户对比学习**：同一个用户在不同领域的表现具有更高的相关性，因此通过不同领域中相同用户的嵌入来进行对比学习。
     - **用户-项目对比学习**：考虑到用户在一个领域的行为可能与其在另一个领域的行为相关，例如用户喜欢动作电影可能也会偏好相关类型的书籍，因此通过用户在一个领域的项目嵌入与另一个领域的用户嵌入进行对比来传递知识。
     - **项目-项目对比学习**：通过对比同一用户在不同领域中交互的项目嵌入，来实现跨域项目的知识传递。
  4. **嵌入中心校准模块**：由于对比学习会将相似的嵌入拉近，这一过程会导致目标域中嵌入的几何中心偏离双曲流形的北极点，从而导致嵌入中心偏移，该模块通过将嵌入投影回切向空间，并计算几何中心的偏移来校准嵌入，确保嵌入的几何结构不会失真。

- **数据集：**在下面几个跨域场景下进行实验：

  1. Amazon(Movie/Book)
  2. Amazon(Book/Music)
  3. Amazon(Movie/Toy)
  4. Douban(Book/Music)
  5. Douban(Movie/Book)
  6. Douban(Movie/Music)

**4、Pre-trained Sequential Recommendation Framework via Popularity Dynamics**

> 期刊会议：Recsys2024
> 方向分类：跨域零样本序列推荐

- **解决的问题：**传统的序列推荐模型在不同应用或域之间难以泛化，必须针对每个领域单独训练模型，并且需要辅助信息（如商品描述等）。本研究提出了一种不依赖任何辅助信息的预训练序列推荐框架，以解决跨领域推荐的挑战。
- **创新点：**提出了一个基于物品**流行度动态**的预训练序列推荐框架PrepRec，通过建模物品流行度的变化来学习通用的物品和序列表示。该模型不依赖具体物品的ID或辅助信息，可以实现零样本的跨域和跨应用推荐。
- **模型架构：**
  - **物品流行度编码器**：模型通过两种时间粒度（长期和短期）来编码物品的流行度动态。长期流行度反映物品的整体受欢迎程度，短期流行度反映近期的趋势变化。
  - **通用物品表示**：通过结合粗粒度和细粒度的流行度动态来生成通用的物品表示，避免了对具体物品ID的依赖。
  - **流行度动态感知Transformer**：该架构结合物品流行度、相对时间间隔编码和位置编码，通过多头自注意力机制学习用户的行为序列表示。
  - **预测模块**：模型利用用户序列的输出与下一个物品的表示计算内积，进行推荐预测。
- **数据集：**在下面三个跨域场景下进行实验：
  - Amazon(Office/Tool)
  - Douban(Movie/Music)
  - Epinions



**5、Preference Prototype-Aware Learning for Universal Cross-Domain Recommendation**

> 期刊会议：CIKM2024
> 方向分类：跨域推荐/用户偏好建模

- **解决的问题：**跨域推荐中因源域冗余的项目特征干扰而导致推荐效果不佳的问题。传统方法主要通过提取特定的项目特征来进行用户偏好建模，但这些特征的冗余可能影响用户真实偏好的捕捉，从而降低跨域推荐的准确性和泛化能力。

- **创新点：**提出了一种偏好**原型感知学习**（PPA）方法，通过构建偏好原型以量化用户偏好，从而减少源域冗余特征的影响。

  > 什么是**原型学习**(Prototype Learning)
  >
  > 原型学习是一种基于示例的机器学习方法，它通过少量的原型（或称为“**代表性示例**”）来表征不同类别的特征，旨在使模型能够更具解释性地做出分类或预测。<u>每个原型可以被视为一个类别的典型特征，模型通过匹配输入数据与这些原型的相似度来决定该输入数据属于哪个类别。</u>
  >
  > 在原型学习中，模型通过学习具有代表性的原型来捕捉不同类别或群组的核心特征，这些特征需要在所属类别中保持稳定，同时在不同类别间具有辨别力。通过这种方式，模型在面对新数据时，可以通过与已知原型的对比快速找到匹配的类别，而不需要复杂的计算或大量的样本数据。这种方式也提高了模型的可解释性，因为原型为人类提供了一个可理解的“参考点”，便于解释模型的预测依据。

- **模型架构：**PPA模型由两个模块组成：

  - **混合编码器**：用于从互动项目中提取有效的表示。它通过权重得分引导项目嵌入，生成适应性更强的项目特征表示，能够捕捉不同域内的深层关系。编码器包含两条分支：一条处理特定域的嵌入，另一条处理全局域的嵌入。
  - **偏好原型感知解码器**：采用可学习的偏好原型对用户兴趣进行建模。通过将用户偏好划分为若干可适应的原型（例如正偏好和负偏好原型），解码器能够精准地捕捉用户对目标项目的偏好，并将源域的特征引导至共享域。最终生成的用户特征用于进一步的推荐。该模块包含了多种损失约束（如聚类损失和分离损失）以保证偏好的区分度和多样性。

- **数据集：**在下面几个跨域场景下进行实验：

  1. 场景1（双域内推荐）：

     - Amazon(Sports/Cloth)
     - Amazon(Elec/Phone)

  2. 场景2（双域间推荐）：

     - Amazon(Sports/Cloth)
     - Amazon(Game/Video)

  3. 场景3（项目重叠的多域内推荐）：

     - XMarket dataset

  4. 场景4（用户重叠的多域内推荐）：

     UniCDR构建的一个来自三个在线银行平台的真实金融数据集

## 二、对比总结

**相似点**

1. **用户表示和偏好建模：**第1篇（DiCUR-CDR）、第2篇（CDAT）和第5篇（PPA）都强调用户表示和偏好建模的重要性。DiCUR-CDR通过判别典型相关分析进行用户表示学习；CDAT使用领域对抗网络来捕获领域不变的用户偏好分布；PPA则使用偏好原型感知学习来精确建模用户兴趣。
2. **对抗性学习的应用：**第1篇（DiCUR-CDR）和第2篇（CDAT）都用到了生成对抗网络(GAN)的思想。DiCUR-CDR通过生成器和判别器的竞争，学习用户偏好分布，生成更符合用户偏好的推荐结果；CDAT则设计了领域对抗网络和跨域对抗样本生成网络，前者用于捕获领域不变的用户偏好分布，后者用于生成高质量的跨域对抗样本。